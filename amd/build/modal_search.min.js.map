{"version":3,"sources":["../src/modal_search.js"],"names":["define","exports","$","ajax","ModalFactory","ModalEvents","Notification","Modal","CustomEvents","ModalRegistry","fn","serializeAssoc","data","each","serializeArray","key","obj","a","name","match","subName","subKey","length","isArray","push","value","SELECTORS","SEARCH_TEXTBOX","START_SEARCH","START_SEARCH_CLEAR","CANCEL_BUTTON","CONTENT_BLOCK","CONTENT_NAME","TRIGGER_BOOK","ADD_BOOK","CATEGORY_BUTTON","CATEGORY_BLOCK","LEVEL_BLOCK","BOOK_PAGINATION","START_PAGE_CLASS","END_PAGE_CLASS","PROGRESS","LIMIT_ON_PAGE","ModalSearch","root","call","getBody","find","exception","message","TYPE","prototype","Object","create","constructor","registerEventListeners","submitFunction","e","preventDefault","stopPropagation","id","attr","levelId","args","searchParam","target","form","page","limit","catId","toggleClass","getAjaxCall","getSearchResult","then","resetPagination","getModal","on","events","activate","bind","val","trigger","disabledEnterSubmit","keyCode","setPagination","currentTarget","hasClass","maxPage","parseInt","prevPage","closest","nextPage","currentPage","removeClass","addClass","text","disabledKeyUp","getCategoryTree","categoryId","printCategories","response","empty","Math","ceil","meta","total","number","item","descriptionBlock","description","isbn","authors","append","book_id","image","title","pubhouses","year","longtitle","bookId","win","window","open","focus","contentName","siblings","resName","resAuthors","split","resTitle","resType","pagetitle","click","prepend","printError","printLevels","level","methodname","callback","done","body","JSON","parse","fail","preloadModalData","register"],"mappings":"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","sourcesContent":["define([\"exports\", \"jquery\", \"core/ajax\", \"core/modal_factory\", \"core/modal_events\", \"core/notification\", \"core/modal\",\n        \"core/custom_interaction_events\", \"core/modal_registry\", \"mod_rki/modal_book\", \"mod_rki/modal_book_handle\"],\n    function (exports, $, ajax, ModalFactory, ModalEvents, Notification, Modal,\n              CustomEvents, ModalRegistry) {\n\n        $.fn.serializeAssoc = function () {\n            var data = {};\n            $.each(this.serializeArray(), function (key, obj) {\n                var a = obj.name.match(/(.*?)\\[(.*?)\\]/);\n                if (a !== null) {\n                    var subName = a[1];\n                    var subKey = a[2];\n\n                    if (!data[subName]) {\n                        data[subName] = [];\n                    }\n\n                    if (!subKey.length) {\n                        subKey = data[subName].length;\n                    }\n\n                    if (data[subName][subKey]) {\n                        if ($.isArray(data[subName][subKey])) {\n                            data[subName][subKey].push(obj.value);\n                        } else {\n                            data[subName][subKey] = [];\n                            data[subName][subKey].push(obj.value);\n                        }\n                    } else {\n                        data[subName][subKey] = obj.value;\n                    }\n                } else {\n                    if (data[obj.name]) {\n                        if ($.isArray(data[obj.name])) {\n                            data[obj.name].push(obj.value);\n                        } else {\n                            data[obj.name] = [];\n                            data[obj.name].push(obj.value);\n                        }\n                    } else {\n                        data[obj.name] = obj.value;\n                    }\n                }\n            });\n            return data;\n        };\n\n        let SELECTORS = {\n            SEARCH_TEXTBOX: \"[data-action='search_text']\",\n            START_SEARCH: \"[data-action='search_button']\",\n            START_SEARCH_CLEAR: \"[name='clear_search']\",\n            CANCEL_BUTTON: \"[data-action='cancel_button']\",\n            CONTENT_BLOCK: \"[data-action='content_block']\",\n            CONTENT_NAME: \"[name='content_name']\",\n            TRIGGER_BOOK: \".trigger_book\",\n            ADD_BOOK: \"[name='add_book']\",\n            CATEGORY_BUTTON: \"[data-action='category_tree']\",\n            CATEGORY_BLOCK: \"[data-action='categories']\",\n            LEVEL_BLOCK: \"[data-action='levels']\",\n            BOOK_PAGINATION: \"#books_pagination li.page-item\",\n            START_PAGE_CLASS: \"page-start\",\n            END_PAGE_CLASS: \"page-end\",\n            PROGRESS: \".loader\",\n        };\n        let LIMIT_ON_PAGE = 10;\n\n        /**\n         * Constructor for the Modal\n         *\n         */\n        let ModalSearch = function (root) {\n            Modal.call(this, root);\n\n            if (!this.getBody().find(SELECTORS.SEARCH_TEXTBOX).length) {\n                Notification.exception({message: 'text box not found'});\n            }\n            if (!this.getBody().find(SELECTORS.START_SEARCH).length) {\n                Notification.exception({message: 'search button not found'});\n            }\n        };\n\n        ModalSearch.TYPE = 'mod_rki-search';\n        ModalSearch.prototype = Object.create(Modal.prototype);\n        ModalSearch.prototype.constructor = ModalSearch;\n\n        ModalSearch.prototype.registerEventListeners = function () {\n            Modal.prototype.registerEventListeners.call(this);\n            let disabledEnterSubmit = function (e) {\n                if (e.keyCode === 13) {\n                    submitFunction(e);\n                    return false;\n                }\n            };\n            let disabledKeyUp = function (e) {\n                if (e.keyCode !== false) {\n                    e.preventDefault();\n                    return false;\n                }\n            };\n            let submitFunction = function (e) {\n                e.preventDefault();\n                e.stopPropagation();\n                let id = $(SELECTORS.CATEGORY_BLOCK).attr('data-id');\n                let levelId = $(SELECTORS.LEVEL_BLOCK).attr('data-id');\n                let args = {\n                    searchParam: $(e.target.form).serializeAssoc(),\n                    page: 1,\n                    limit: LIMIT_ON_PAGE,\n                    catId: id,\n                    levelId: levelId\n                };\n                $(SELECTORS.PROGRESS).toggleClass('hide');\n                ModalSearch.prototype.getAjaxCall('mod_rki_search_books', args, ModalSearch.prototype.getSearchResult)\n                    .then(function () {\n                        ModalSearch.prototype.resetPagination();\n                        $(SELECTORS.PROGRESS).toggleClass('hide');\n                    });\n            };\n\n            let getCategoryTree = function (e) {\n                e.preventDefault();\n                e.stopPropagation();\n                let categoryId = [null];\n                let args = {\n                    categoryId: categoryId\n                };\n                ModalSearch.prototype.getAjaxCall('mod_rki_category_tree', args, ModalSearch.prototype.printCategories);\n            };\n\n            let setPagination = function (e) {\n                if ($(e.currentTarget).hasClass('disabled')) {\n                    return true;\n                }\n                let page, maxPage;\n                if ($(SELECTORS.CONTENT_BLOCK).attr('data-page') === undefined) {\n                    maxPage = 0;\n                } else {\n                    maxPage = parseInt($(SELECTORS.CONTENT_BLOCK).attr('data-page'));\n                }\n                if ($(e.currentTarget).hasClass(SELECTORS.START_PAGE_CLASS)) {\n                    if (maxPage > 0) {\n                        page = 1;\n                    } else {\n                        page = 0;\n                    }\n                } else if ($(e.currentTarget).hasClass(SELECTORS.END_PAGE_CLASS)) {\n                    page = maxPage;\n                } else {\n                    page = parseInt($(e.currentTarget).attr('data-page'));\n                }\n                let id = $(SELECTORS.CATEGORY_BLOCK).attr('data-id');\n                let levelId = $(SELECTORS.LEVEL_BLOCK).attr('data-id');\n                let args = {\n                    searchParam: {'searchString': $(SELECTORS.SEARCH_TEXTBOX).val()},\n                    page: page,\n                    limit: LIMIT_ON_PAGE,\n                    catId: id,\n                    levelId: levelId\n                };\n                let prevPage = $(SELECTORS.BOOK_PAGINATION).find('a.prev').closest('li.page-item');\n                let nextPage = $(SELECTORS.BOOK_PAGINATION).find('a.next').closest('li.page-item');\n                let currentPage = $(SELECTORS.BOOK_PAGINATION).find('a.active').closest('li.page-item');\n                if (page >= 2) {\n                    $(prevPage).attr('data-page', page - 1);\n                    $(prevPage).removeClass('disabled');\n                } else if (page === 1) {\n                    $(prevPage).attr('data-page', page - 1);\n                    $(prevPage).addClass('disabled');\n                }\n                if (maxPage === page) {\n                    $(nextPage).addClass('disabled');\n                } else {\n                    $(nextPage).removeClass('disabled');\n                }\n                $(nextPage).attr('data-page', page + 1);\n                $(currentPage).attr('data-page', page);\n                $(currentPage).find('a.active').text(page + ' из ' + maxPage);\n                if (page !== 0 && maxPage !== 0) {\n                    ModalSearch.prototype.getAjaxCall('mod_rki_search_books', args, ModalSearch.prototype.getSearchResult);\n                }\n            };\n\n            this.getModal().on(CustomEvents.events.activate, SELECTORS.START_SEARCH, submitFunction.bind(this));\n            this.getModal().on('click', SELECTORS.START_SEARCH_CLEAR, function (e) {\n                e.preventDefault();\n                e.stopPropagation();\n                $(SELECTORS.SEARCH_TEXTBOX).val('');\n                $(SELECTORS.START_SEARCH).trigger('click');\n                return false;\n            });\n            this.getModal().on('keypress', SELECTORS.SEARCH_TEXTBOX, disabledEnterSubmit.bind(this));\n            this.getModal().on(CustomEvents.events.activate, SELECTORS.BOOK_PAGINATION, setPagination.bind(this));\n            this.getModal().on('keydown', SELECTORS.CONTENT_NAME, disabledKeyUp.bind(this));\n\n            this.getModal().on(CustomEvents.events.activate, SELECTORS.CANCEL_BUTTON, function () {\n                $(this).trigger('hide');\n            }.bind(this));\n\n            this.getModal().on(CustomEvents.events.activate, SELECTORS.CATEGORY_BUTTON, getCategoryTree.bind(this));\n        };\n\n        ModalSearch.prototype.getSearchResult = function (response) {\n            $(SELECTORS.CONTENT_BLOCK).empty();\n            let maxPage = Math.ceil(response.meta.total / LIMIT_ON_PAGE);\n\n            if (response.meta.total > 0) {\n                $.each(response.data, function (number, item) {\n                    let descriptionBlock =\n                        '<a class=\"\" data-toggle=\"collapse\" href=\"#collapseDescription' + item.id + '\" role=\"button\">' +\n                        'Подробнее об издании' +\n                        '</a><br>' +\n                        '<div class=\"collapse\" id=\"collapseDescription' + item.id + '\">' +\n                        '<span><strong>Описание: </strong>' + item.description + '</span><br><br>' +\n                        '<span><strong>ISBN: </strong>' + item.isbn + '</span><br><br>' +\n                        '</div>';\n\n                    if (item.description === null || item.description === '') {\n                        item.description = '';\n                        descriptionBlock = '';\n                    }\n                    if (item.authors === null || item.authors === '') {\n                        item.authors = '';\n                    }\n                    $(SELECTORS.CONTENT_BLOCK).append(\n                        '<div class=\"row\" data-id=\"' + item.book_id + '\">' +\n                        '<div class=\"col-sm-2\" >' +\n                        '<img src=\"https://www.ros-edu.ru/' + item.image + '\" class=\"img-responsive thumbnail\" alt=\"\">' +\n                        '</div>' +\n                        '<div class=\"col-sm-8\">' +\n                        '<span class=\"book_title\" data-val=\"' + item.title + '\"><strong>Название: </strong>' +\n                        item.title + '</span><br>' +\n                        '<span class=\"book_authors\" data-val=\"' + item.authors + '\"><strong>Авторы: </strong>' +\n                        item.authors + '</span><br>' +\n                        '<span><strong>Издательство: </strong>' + item.pubhouses + '</span><br>' +\n                        '<span><strong>Год издания: </strong>' + item.year + '</span><br>' +\n                        '<span><strong>Тип издания: </strong>' + item.longtitle + '</span><br><br>' +\n                        '<span class=\"book_title_additional\" style=\"display: none\" data-val=\"' + item.longtitle + '\">' +\n                        item.longtitle + '</span><br>' +\n                        descriptionBlock +\n                        '</div>' +\n                        '<div class=\"col-sm-2\">' +\n                        '<button type=\"button\" name=\"add_book\" class=\"btn btn-sm\" style=\"color: #a53436;' +\n                        'background-color: white;border-color: #a53436;width: 140px;\">Добавить</button>' +\n                        '<button type=\"button\" class=\"trigger_book btn btn-sm mt-2\" style=\"color: #a53436;' +\n                        'background-color: white;border-color: #a53436;width: 140px;\">Предпросмотр</button>' +\n                        '<br>' +\n                        '</div>' +\n                        '</div><hr>');\n                });\n            } else {\n                $(SELECTORS.CONTENT_BLOCK).append('<div class=\"item h4\">Книги не найдены</div>');\n            }\n            $(SELECTORS.CONTENT_BLOCK).attr('data-page', maxPage);\n            $(SELECTORS.TRIGGER_BOOK).on('click', function (e) {\n                let bookId = $(e.target).closest('.row').attr('data-id');\n                let args = {\n                    bookId: bookId,\n                };\n\n                ModalSearch.prototype.getAjaxCall('mod_rki_book_read_url', args, function (response) {\n                    var win = window.open(response.data, '_blank');\n                    win.focus();\n                });\n            });\n            $(SELECTORS.ADD_BOOK).on('click', function (e) {\n                let id = $(e.target).closest('.row').attr('data-id');\n                let contentName = $('[name=\"content_name\"]');\n                contentName.val($(e.target).closest('.row').find('.book_title').attr('data-val'));\n                contentName.removeClass('is-invalid');\n                contentName.siblings('#id_error_content_name').text('');\n\n                let resName = $('[name=\"name\"]');\n                let resAuthors = $(e.target).closest('.row').find('.book_authors').attr('data-val').split(\",\");\n                let resTitle = $(e.target).closest('.row').find('.book_title').attr('data-val');\n                let resType = $(e.target).closest('.row').find('.book_title_additional').attr('data-val');\n                resName.val(resAuthors[0] + ', ' + resTitle + \": \" + resType);\n                resName.removeClass('is-invalid');\n                resName.siblings('#id_error_content_name').text('');\n\n                $('[name=\"content\"]').val(id);\n                $(SELECTORS.CANCEL_BUTTON).trigger('click');\n            });\n        };\n\n        ModalSearch.prototype.printCategories = function (response) {\n            $(SELECTORS.CATEGORY_BLOCK).empty();\n            $.each(response.data, function (number, item) {\n                $(SELECTORS.CATEGORY_BLOCK).append(\n                    '<div style=\"cursor:pointer;color:#174c8d;background-color:white;\" ' +\n                    'class=\"item btn-sm' + (item.id === 0 ? ' bg-primary' : '') + '\" data-id=\"' + item.id + '\">' +\n                    '<span>' + item.pagetitle +\n                    '</span>' +\n                    '</div>');\n\n                $(SELECTORS.CATEGORY_BLOCK).find('[data-id=\"' + item.id + '\"]').click({item: item}, function (e) {\n                    e.stopPropagation();\n                    e.preventDefault();\n                    $(SELECTORS.CATEGORY_BLOCK).attr('data-id', $(e.currentTarget).attr('data-id'));\n\n                    if (!$(this).hasClass('bg-primary')) {\n                        $(this).addClass('bg-primary');\n                        $(this).siblings().removeClass('bg-primary');\n                    }\n\n                    $(SELECTORS.START_SEARCH).trigger('click');\n                });\n            });\n\n            $(SELECTORS.CATEGORY_BLOCK).prepend(\n                '<div ' + 'class=\"btn-sm\">' +\n                '<h5>Категории</h5>' +\n                '</div>'\n            );\n        };\n\n        ModalSearch.prototype.printError = function (response) {\n            $(\".modal-body\").empty().append(\"<h2 style=\\\"text-align: center;\\\">Ошибка: \" + response.message +\n                \"<br/> Обратитесь в службу технической поддержки</h2>\");\n            $(\".modal-footer\").empty();\n        };\n\n        ModalSearch.prototype.printLevels = function (response) {\n            $(SELECTORS.LEVEL_BLOCK).empty();\n            $.each(response.data, function (number, item) {\n                $(SELECTORS.LEVEL_BLOCK).append(\n                    '<div style=\"cursor:pointer;color:#174c8d;background-color:white;\" ' +\n                    'class=\"item btn-sm' + (item.id === 0 ? ' bg-primary' : '') + '\" data-id=\"' + item.id + '\">' +\n                    '<span>' + item.level +\n                    '</span>' +\n                    '</div>');\n\n                $(SELECTORS.LEVEL_BLOCK).find('[data-id=\"' + item.id + '\"]').click({item: item}, function (e) {\n                    e.stopPropagation();\n                    e.preventDefault();\n                    $(SELECTORS.LEVEL_BLOCK).attr('data-id', $(e.currentTarget).attr('data-id'));\n\n                    if (!$(this).hasClass('bg-primary')) {\n                        $(this).addClass('bg-primary');\n                        $(this).siblings().removeClass('bg-primary');\n                    }\n\n                    $(SELECTORS.START_SEARCH).trigger('click');\n                });\n            });\n\n            $(SELECTORS.LEVEL_BLOCK).prepend(\n                '</br><div ' + 'class=\"btn-sm\">' +\n                '<h5>Категории</h5>' +\n                '</div>'\n            );\n        };\n\n        ModalSearch.prototype.getAjaxCall = function (methodname, args, callback) {\n            return ajax.call([\n                {\n                    methodname: methodname,\n                    args,\n                }\n            ])[0].then(function (response) {\n                return response;\n            }).done(function (response) {\n                let body = JSON.parse(response['body']);\n                if (body[\"meta\"] !== undefined && body[\"meta\"][\"success\"] !== undefined && body[\"meta\"][\"success\"] !== false) {\n                    callback(body);\n                } else {\n                    ModalSearch.prototype.printError(body);\n                }\n                return true;\n            }).fail(function () {\n                return false;\n            });\n        };\n\n        ModalSearch.prototype.preloadModalData = function () {\n            let categoryId = [null];\n            let args = {\n                categoryId: categoryId\n            };\n            ModalSearch.prototype.getAjaxCall('mod_rki_category_tree', args, function (response) {\n                ModalSearch.prototype.printCategories(response);\n\n                ModalSearch.prototype.getAjaxCall('mod_rki_level_tree', args, function (response) {\n                    ModalSearch.prototype.printLevels(response);\n                    $(SELECTORS.START_SEARCH).trigger('click');\n                });\n            });\n        };\n\n        ModalSearch.prototype.resetPagination = function () {\n            let maxPage = parseInt($(SELECTORS.CONTENT_BLOCK).attr('data-page'));\n            $(SELECTORS.BOOK_PAGINATION).find('a.prev').closest('li.page-item').addClass('disabled');\n            $(SELECTORS.BOOK_PAGINATION).find('a.prev').closest('li.page-item').attr('data-page', 0);\n            $(SELECTORS.BOOK_PAGINATION).find('a.active').closest('li.page-item').attr('data-page', 1);\n            $(SELECTORS.BOOK_PAGINATION).find('a.next').closest('li.page-item').attr('data-page', 2);\n            if (maxPage > 1) {\n                $(SELECTORS.BOOK_PAGINATION).find('a.active').text(1 + ' из ' + maxPage);\n                $(SELECTORS.BOOK_PAGINATION).find('a.next').closest('li.page-item').removeClass('disabled');\n            } else {\n                $(SELECTORS.BOOK_PAGINATION).find('a.active').text(maxPage + ' из ' + maxPage);\n                $(SELECTORS.BOOK_PAGINATION).find('a.next').closest('li.page-item').addClass('disabled');\n            }\n        };\n\n        ModalRegistry.register(ModalSearch.TYPE, ModalSearch, 'mod_rki/modal_search');\n\n        return ModalSearch;\n    });"],"file":"modal_search.min.js"}